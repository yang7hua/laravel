<!doctype html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <title>Events - Laravel 5.1 中文文档 | Laravel 中文网</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Laravel 中文网">
    <meta name="description" content="Laravel - 为 WEB 艺术家创造的 PHP 框架。| Laravel 中文网">
    <meta name="keywords" content="Laravel中文社区,php框架,laravel中文网,php framework,restful routing,laravel,laravel php">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--[if lte IE 9]>
		<script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../../assets/css/laravel.css">
    <link rel="stylesheet" href="../../assets/css/patch.css">
</head>

<body class="docs language-php">

    <span class="overlay"></span>

    <nav class="main">
        <div class="container">
            <a href="http://www.golaravel.com/laravel/" class="brand">
                <img src="../../assets/img/laravel-logo.png" height="30"> Laravel
            </a>

            <div class="responsive-sidebar-nav">
                <a href="events#" class="toggle-slide menu-link btn">&#9776;</a>
            </div>

            <div class="switcher">
                <div class="dropdown">
                    <button class="btn dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
                        <!--<span class="faint">v</span> -->
                        5.1
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                        <li role="presentation">
                            <a role="menuitem" tabindex="-1" href="index.html">5.1</a>
                        </li>
                        <li role="presentation">
                            <a role="menuitem" tabindex="-1" href="http://www.golaravel.com/laravel/docs/5.0">5.0</a>
                        </li>
                        <li role="presentation">
                            <a role="menuitem" tabindex="-1" href="http://www.golaravel.com/laravel/docs/4.2">4.2</a>
                        </li>
                        <li role="presentation">
                            <a role="menuitem" tabindex="-1" href="http://www.golaravel.com/laravel/docs/4.1">4.1</a>
                        </li>
                        <li role="presentation">
                            <a role="menuitem" tabindex="-1" href="http://www.golaravel.com/laravel/docs/4.0">4.0</a>
                        </li>
                    </ul>
                </div>
            </div>

            <ul class="main-nav">
                <li class="nav-docs"><a href="http://www.golaravel.com/laravel/docs/">中文文档</a>
                </li>
                <li class="nav-community"><a href="http://wenda.golaravel.com" target="_blank">问答社区</a>
                </li>
                <li class="nav-api"><a href="http://laravel.com/api/5.0/" target="_blank">API</a>
                </li>
                <li class="nav-laracasts"><a href="https://laracasts.com" target="_blank">视频教程（国外）</a>
                </li>
                <li class="nav-forge"><a href="https://forge.laravel.com" target="_blank">Forge</a>
                </li>

            </ul>
        </div>
    </nav>

    <nav id="slide-menu" class="slide-menu" role="navigation">

        <div class="brand">
            <a href="http://www.golaravel.com/laravel/">
                <img src="../../assets/img/laravel-logo-white.png" height="50">
            </a>
        </div>

        <ul class="slide-main-nav">
            <li><a href="http://www.golaravel.com/laravel/">首页</a>
            </li>
            <li class="nav-docs"><a href="http://www.golaravel.com/laravel/docs/">中文文档</a>
            </li>
            <li class="nav-community"><a href="http://wenda.golaravel.com" target="_blank">问答社区</a>
            </li>
            <li class="nav-api"><a href="http://laravel.com/api/5.0/" target="_blank">API</a>
            </li>
            <li class="nav-laracasts"><a href="https://laracasts.com" target="_blank">视频教程（国外）</a>
            </li>
            <li class="nav-forge"><a href="https://forge.laravel.com" target="_blank">Forge</a>
            </li>

        </ul>

        <div class="slide-docs-nav">
            <h2>文档目录</h2>
            <ul>
                <li>序言
                    <ul>
                        <li><a href="releases">版本说明</a>
                        </li>
                        <li><a href="upgrade">升级指南</a>
                        </li>
                        <li><a href="contributions">贡献指南</a>
                        </li>
                        <li><a href="http://www.golaravel.com/laravel/api/5.1">API 文档</a>
                        </li>
                    </ul>
                </li>
                <li>安装设置
                    <ul>
                        <li><a href="installation">安装</a>
                        </li>
                        <li><a href="homestead">Homestead</a>
                        </li>
                    </ul>
                </li>
                <li>教程
                    <ul>
                        <li><a href="quickstart">入门学习任务</a>
                        </li>
                        <li><a href="quickstart-intermediate">中级学习任务</a>
                        </li>
                    </ul>
                </li>
                <li>基础知识
                    <ul>
                        <li><a href="routing">路由</a>
                        </li>
                        <li><a href="middleware">中间件</a>
                        </li>
                        <li><a href="controllers">控制器</a>
                        </li>
                        <li><a href="requests">请求</a>
                        </li>
                        <li><a href="responses">响应</a>
                        </li>
                        <li><a href="views">视图</a>
                        </li>
                        <li><a href="blade">Blade 模板</a>
                        </li>
                    </ul>
                </li>
                <li>系统架构
                    <ul>
                        <li><a href="lifecycle">请求的生命周期</a>
                        </li>
                        <li><a href="structure">应用程序结构</a>
                        </li>
                        <li><a href="providers">服务提供者</a>
                        </li>
                        <li><a href="container">服务容器</a>
                        </li>
                        <li><a href="contracts">Contract</a>
                        </li>
                        <li><a href="facades">Facade</a>
                        </li>
                    </ul>
                </li>
                <li>系统服务
                    <ul>
                        <li><a href="authentication">认证</a>
                        </li>
                        <li><a href="authorization">授权</a>
                        </li>
                        <li><a href="artisan">Artisan 控制台</a>
                        </li>
                        <li><a href="billing">计费</a>
                        </li>
                        <li><a href="cache">缓存</a>
                        </li>
                        <li><a href="collections">集合</a>
                        </li>
                        <li><a href="elixir">Elixir</a>
                        </li>
                        <li><a href="encryption">加密</a>
                        </li>
                        <li><a href="errors">错误与日志</a>
                        </li>
                        <li><a href="events">事件</a>
                        </li>
                        <li><a href="filesystem">文件系统 / 云存储</a>
                        </li>
                        <li><a href="hashing">哈希</a>
                        </li>
                        <li><a href="helpers">辅助方法</a>
                        </li>
                        <li><a href="localization">本地化</a>
                        </li>
                        <li><a href="mail">邮件</a>
                        </li>
                        <li><a href="packages">扩展包开发</a>
                        </li>
                        <li><a href="pagination">分页</a>
                        </li>
                        <li><a href="queues">队列</a>
                        </li>
                        <li><a href="redis">Redis</a>
                        </li>
                        <li><a href="session">会话</a>
                        </li>
                        <li><a href="envoy">SSH 任务</a>
                        </li>
                        <li><a href="scheduling">任务调度</a>
                        </li>
                        <li><a href="testing">测试</a>
                        </li>
                        <li><a href="validation">验证</a>
                        </li>
                    </ul>
                </li>
                <li>数据库
                    <ul>
                        <li><a href="database">入门</a>
                        </li>
                        <li><a href="queries">查询构造器</a>
                        </li>
                        <li><a href="migrations">迁移</a>
                        </li>
                        <li><a href="seeding">数据填充</a>
                        </li>
                    </ul>
                </li>
                <li>Eloquent ORM
                    <ul>
                        <li><a href="eloquent">入门</a>
                        </li>
                        <li><a href="eloquent-relationships">关系</a>
                        </li>
                        <li><a href="eloquent-collections">集合</a>
                        </li>
                        <li><a href="eloquent-mutators">调整修改</a>
                        </li>
                        <li><a href="eloquent-serialization">序列化</a>
                        </li>
                    </ul>
                </li>
            </ul>

        </div>

    </nav>

    <div class="docs-wrapper container">

        <section class="sidebar">
            <ul>
                <li>序言
                    <ul>
                        <li><a href="releases">版本说明</a>
                        </li>
                        <li><a href="upgrade">升级指南</a>
                        </li>
                        <li><a href="contributions">贡献指南</a>
                        </li>
                        <li><a href="http://www.golaravel.com/laravel/api/5.1">API 文档</a>
                        </li>
                    </ul>
                </li>
                <li>安装设置
                    <ul>
                        <li><a href="installation">安装</a>
                        </li>
                        <li><a href="homestead">Homestead</a>
                        </li>
                    </ul>
                </li>
                <li>教程
                    <ul>
                        <li><a href="quickstart">入门学习任务</a>
                        </li>
                        <li><a href="quickstart-intermediate">中级学习任务</a>
                        </li>
                    </ul>
                </li>
                <li>基础知识
                    <ul>
                        <li><a href="routing">路由</a>
                        </li>
                        <li><a href="middleware">中间件</a>
                        </li>
                        <li><a href="controllers">控制器</a>
                        </li>
                        <li><a href="requests">请求</a>
                        </li>
                        <li><a href="responses">响应</a>
                        </li>
                        <li><a href="views">视图</a>
                        </li>
                        <li><a href="blade">Blade 模板</a>
                        </li>
                    </ul>
                </li>
                <li>系统架构
                    <ul>
                        <li><a href="lifecycle">请求的生命周期</a>
                        </li>
                        <li><a href="structure">应用程序结构</a>
                        </li>
                        <li><a href="providers">服务提供者</a>
                        </li>
                        <li><a href="container">服务容器</a>
                        </li>
                        <li><a href="contracts">Contract</a>
                        </li>
                        <li><a href="facades">Facade</a>
                        </li>
                    </ul>
                </li>
                <li>系统服务
                    <ul>
                        <li><a href="authentication">认证</a>
                        </li>
                        <li><a href="authorization">授权</a>
                        </li>
                        <li><a href="artisan">Artisan 控制台</a>
                        </li>
                        <li><a href="billing">计费</a>
                        </li>
                        <li><a href="cache">缓存</a>
                        </li>
                        <li><a href="collections">集合</a>
                        </li>
                        <li><a href="elixir">Elixir</a>
                        </li>
                        <li><a href="encryption">加密</a>
                        </li>
                        <li><a href="errors">错误与日志</a>
                        </li>
                        <li><a href="events">事件</a>
                        </li>
                        <li><a href="filesystem">文件系统 / 云存储</a>
                        </li>
                        <li><a href="hashing">哈希</a>
                        </li>
                        <li><a href="helpers">辅助方法</a>
                        </li>
                        <li><a href="localization">本地化</a>
                        </li>
                        <li><a href="mail">邮件</a>
                        </li>
                        <li><a href="packages">扩展包开发</a>
                        </li>
                        <li><a href="pagination">分页</a>
                        </li>
                        <li><a href="queues">队列</a>
                        </li>
                        <li><a href="redis">Redis</a>
                        </li>
                        <li><a href="session">会话</a>
                        </li>
                        <li><a href="envoy">SSH 任务</a>
                        </li>
                        <li><a href="scheduling">任务调度</a>
                        </li>
                        <li><a href="testing">测试</a>
                        </li>
                        <li><a href="validation">验证</a>
                        </li>
                    </ul>
                </li>
                <li>数据库
                    <ul>
                        <li><a href="database">入门</a>
                        </li>
                        <li><a href="queries">查询构造器</a>
                        </li>
                        <li><a href="migrations">迁移</a>
                        </li>
                        <li><a href="seeding">数据填充</a>
                        </li>
                    </ul>
                </li>
                <li>Eloquent ORM
                    <ul>
                        <li><a href="eloquent">入门</a>
                        </li>
                        <li><a href="eloquent-relationships">关系</a>
                        </li>
                        <li><a href="eloquent-collections">集合</a>
                        </li>
                        <li><a href="eloquent-mutators">调整修改</a>
                        </li>
                        <li><a href="eloquent-serialization">序列化</a>
                        </li>
                    </ul>
                </li>
            </ul>

        </section>

        <article>
            <h1>Events</h1>
            <ul>
                <li><a href="events#introduction">Introduction</a>
                </li>
                <li><a href="events#registering-events-and-listeners">Registering Events / Listeners</a>
                </li>
                <li><a href="events#defining-events">Defining Events</a>
                </li>
                <li><a href="events#defining-listeners">Defining Listeners</a>
                    <ul>
                        <li><a href="events#queued-event-listeners">Queued Event Listeners</a>
                        </li>
                    </ul>
                </li>
                <li><a href="events#firing-events">Firing Events</a>
                </li>
                <li><a href="events#broadcasting-events">Broadcasting Events</a>
                    <ul>
                        <li><a href="events#broadcast-configuration">Configuration</a>
                        </li>
                        <li><a href="events#marking-events-for-broadcast">Marking Events For Broadcast</a>
                        </li>
                        <li><a href="events#broadcast-data">Broadcast Data</a>
                        </li>
                        <li><a href="events#consuming-event-broadcasts">Consuming Event Broadcasts</a>
                        </li>
                    </ul>
                </li>
                <li><a href="events#event-subscribers">Event Subscribers</a>
                </li>
                <li><a href="events#framework-events">Framework Events</a>
                </li>
            </ul>
            <p>
                <a name="introduction"></a>
            </p>
            <h2>Introduction</h2>
            <p>Laravel's events provides a simple observer implementation, allowing you to subscribe and listen for events in your application. Event classes are typically stored in the <code>app/Events</code> directory, while their listeners are stored
                in <code>app/Listeners</code>.</p>
            <p>
                <a name="registering-events-and-listeners"></a>
            </p>
            <h2>Registering Events / Listeners</h2>
            <p>The <code>EventServiceProvider</code> included with your Laravel application provides a convenient place to register all event listeners. The <code>listen</code> property contains an array of all events (keys) and their listeners (values).
                Of course, you may add as many events to this array as your application requires. For example, let's add our <code>PodcastWasPurchased</code> event:</p>
            <pre><code>/**
 * The event listener mappings for the application.
 *
 * @var array
 */
protected $listen = [
    'App\Events\PodcastWasPurchased' =&gt; [
        'App\Listeners\EmailPurchaseConfirmation',
    ],
];
</code></pre>
            <h3>Generating Event / Listener Classes</h3>
            <p>Of course, manually creating the files for each event and listener is cumbersome. Instead, simply add listeners and events to your <code>EventServiceProvider</code> and use the <code>event:generate</code> command. This command will generate
                any events or listeners that are listed in your <code>EventServiceProvider</code>. Of course, events and listeners that already exist will be left untouched:</p>
            <pre><code>php artisan event:generate
</code></pre>
            <h3>Registering Events Manually</h3>
            <p>Typically, events should be registered via the <code>EventServiceProvider</code> <code>$listen</code> array; however, you may also register events manually with the event dispatcher using either the <code>Event</code> facade or the <code>Illuminate\Contracts\Events\Dispatcher</code>                contract implementation:</p>
            <pre><code>/**
 * Register any other events for your application.
 *
 * @param  \Illuminate\Contracts\Events\Dispatcher  $events
 * @return void
 */
public function boot(DispatcherContract $events)
{
    parent::boot($events);

    $events-&gt;listen('event.name', function ($foo, $bar) {
        //
    });
}
</code></pre>
            <h4>Wildcard Event Listeners</h4>
            <p>You may even register listeners using the <code>*</code> as a wildcard, allowing you to catch multiple events on the same listener. Wildcard listeners receive the entire event data array as a single argument:</p>
            <pre><code>$events-&gt;listen('event.*', function (array $data) {
    //
});
</code></pre>
            <p>
                <a name="defining-events"></a>
            </p>
            <h2>Defining Events</h2>
            <p>An event class is simply a data container which holds the information related to the event. For example, let's assume our generated <code>PodcastWasPurchased</code> event receives an <a href="eloquent">Eloquent ORM</a> object:</p>
            <pre><code>&lt;?php

namespace App\Events;

use App\Podcast;
use App\Events\Event;
use Illuminate\Queue\SerializesModels;

class PodcastWasPurchased extends Event
{
    use SerializesModels;

    public $podcast;

    /**
     * Create a new event instance.
     *
     * @param  Podcast  $podcast
     * @return void
     */
    public function __construct(Podcast $podcast)
    {
        $this-&gt;podcast = $podcast;
    }
}
</code></pre>
            <p>As you can see, this event class contains no special logic. It is simply a container for the <code>Podcast</code> object that was purchased. The <code>SerializesModels</code> trait used by the event will gracefully serialize any Eloquent models
                if the event object is serialized using PHP's <code>serialize</code> function.</p>
            <p>
                <a name="defining-listeners"></a>
            </p>
            <h2>Defining Listeners</h2>
            <p>Next, let's take a look at the listener for our example event. Event listeners receive the event instance in their <code>handle</code> method. The <code>event:generate</code> command will automatically import the proper event class and type-hint
                the event on the <code>handle</code> method. Within the <code>handle</code> method, you may perform any logic necessary to respond to the event.</p>
            <pre><code>&lt;?php

namespace App\Listeners;

use App\Events\PodcastWasPurchased;
use Illuminate\Queue\InteractsWithQueue;
use Illuminate\Contracts\Queue\ShouldQueue;

class EmailPurchaseConfirmation
{
    /**
     * Create the event listener.
     *
     * @return void
     */
    public function __construct()
    {
        //
    }

    /**
     * Handle the event.
     *
     * @param  PodcastWasPurchased  $event
     * @return void
     */
    public function handle(PodcastWasPurchased $event)
    {
        // Access the podcast using $event-&gt;podcast...
    }
}
</code></pre>
            <p>Your event listeners may also type-hint any dependencies they need on their constructors. All event listeners are resolved via the Laravel <a href="container">service container</a>, so dependencies will be injected automatically:</p>
            <pre><code>use Illuminate\Contracts\Mail\Mailer;

public function __construct(Mailer $mailer)
{
    $this-&gt;mailer = $mailer;
}
</code></pre>
            <h4>Stopping The Propagation Of An Event</h4>
            <p>Sometimes, you may wish to stop the propagation of an event to other listeners. You may do so by returning <code>false</code> from your listener's <code>handle</code> method.</p>
            <p>
                <a name="queued-event-listeners"></a>
            </p>
            <h3>Queued Event Listeners</h3>
            <p>Need to <a href="queues">queue</a> an event listener? It couldn't be any easier. Simply add the <code>ShouldQueue</code> interface to the listener class. Listeners generated by the <code>event:generate</code> Artisan command already
                have this interface imported into the current namespace, so you can use it immediately:</p>
            <pre><code>&lt;?php

namespace App\Listeners;

use App\Events\PodcastWasPurchased;
use Illuminate\Queue\InteractsWithQueue;
use Illuminate\Contracts\Queue\ShouldQueue;

class EmailPurchaseConfirmation implements ShouldQueue
{
    //
}
</code></pre>
            <p>That's it! Now, when this listener is called for an event, it will be queued automatically by the event dispatcher using Laravel's <a href="queues">queue system</a>. If no exceptions are thrown when the listener is executed by the
                queue, the queued job will automatically be deleted after it has processed.</p>
            <h4>Manually Accessing The Queue</h4>
            <p>If you need to access the underlying queue job's <code>delete</code> and <code>release</code> methods manually, you may do so. The <code>Illuminate\Queue\InteractsWithQueue</code> trait, which is imported by default on generated listeners,
                gives you access to these methods:</p>
            <pre><code>&lt;?php

namespace App\Listeners;

use App\Events\PodcastWasPurchased;
use Illuminate\Queue\InteractsWithQueue;
use Illuminate\Contracts\Queue\ShouldQueue;

class EmailPurchaseConfirmation implements ShouldQueue
{
    use InteractsWithQueue;

    public function handle(PodcastWasPurchased $event)
    {
        if (true) {
            $this-&gt;release(30);
        }
    }
}
</code></pre>
            <p>
                <a name="firing-events"></a>
            </p>
            <h2>Firing Events</h2>
            <p>To fire an event, you may use the <code>Event</code> <a href="facades">facade</a>, passing an instance of the event to the <code>fire</code> method. The <code>fire</code> method will dispatch the event to all of its registered listeners:</p>
            <pre><code>&lt;?php

namespace App\Http\Controllers;

use Event;
use App\Podcast;
use App\Events\PodcastWasPurchased;
use App\Http\Controllers\Controller;

class UserController extends Controller
{
    /**
     * Show the profile for the given user.
     *
     * @param  int  $userId
     * @param  int  $podcastId
     * @return Response
     */
    public function purchasePodcast($userId, $podcastId)
    {
        $podcast = Podcast::findOrFail($podcastId);

        // Purchase podcast logic...

        Event::fire(new PodcastWasPurchased($podcast));
    }
}
</code></pre>
            <p>Alternatively, you may use the global <code>event</code> helper function to fire events:</p>
            <pre><code>event(new PodcastWasPurchased($podcast));
</code></pre>
            <p>
                <a name="broadcasting-events"></a>
            </p>
            <h2>Broadcasting Events</h2>
            <p>In many modern web applications, web sockets are used to implement real-time, live-updating user interfaces. When some data is updated on the server, a message is typically sent over a websocket connection to be handled by the client.</p>
            <p>To assist you in building these types of applications, Laravel makes it easy to &quot;broadcast&quot; your events over a websocket connection. Broadcasting your Laravel events allows you to share the same event names between your server-side
                code and your client-side JavaScript framework.</p>
            <p>
                <a name="broadcast-configuration"></a>
            </p>
            <h3>Configuration</h3>
            <p>All of the event broadcasting configuration options are stored in the <code>config/broadcasting.php</code> configuration file. Laravel supports several broadcast drivers out of the box: <a href="https://pusher.com" target="_blank">Pusher</a>, <a href="redis">Redis</a>,
                and a <code>log</code> driver for local development and debugging. A configuration example is included for each of these drivers.</p>
            <h4>Broadcast Prerequisites</h4>
            <p>The following dependencies are needed for event broadcasting:</p>
            <ul>
                <li>Pusher: <code>pusher/pusher-php-server ~2.0</code>
                </li>
                <li>Redis: <code>predis/predis ~1.0</code>
                </li>
            </ul>
            <h4>Queue Prerequisites</h4>
            <p>Before broadcasting events, you will also need to configure and run a <a href="queues">queue listener</a>. All event broadcasting is done via queued jobs so that the response time of your application is not seriously affected.</p>
            <p>
                <a name="marking-events-for-broadcast"></a>
            </p>
            <h3>Marking Events For Broadcast</h3>
            <p>To inform Laravel that a given event should be broadcast, implement the <code>Illuminate\Contracts\Broadcasting\ShouldBroadcast</code> interface on the event class. The <code>ShouldBroadcast</code> interface requires you to implement a single
                method: <code>broadcastOn</code>. The <code>broadcastOn</code> method should return an array of &quot;channel&quot; names that the event should be broadcast on:</p>
            <pre><code>&lt;?php

namespace App\Events;

use App\User;
use App\Events\Event;
use Illuminate\Queue\SerializesModels;
use Illuminate\Contracts\Broadcasting\ShouldBroadcast;

class ServerCreated extends Event implements ShouldBroadcast
{
    use SerializesModels;

    public $user;

    /**
     * Create a new event instance.
     *
     * @return void
     */
    public function __construct(User $user)
    {
        $this-&gt;user = $user;
    }

    /**
     * Get the channels the event should be broadcast on.
     *
     * @return array
     */
    public function broadcastOn()
    {
        return ['user.'.$this-&gt;user-&gt;id];
    }
}
</code></pre>
            <p>Then, you only need to <a href="events#firing-events">fire the event</a> as you normally would. Once the event has been fired, a <a href="queues">queued job</a> will automatically broadcast the event over your specified broadcast driver.</p>
            <p>
                <a name="overriding-broadcast-event-name"></a>
            </p>
            <h4>Overriding Broadcast Event Name</h4>
            <p>By default, the broadcast event name will be the fully qualified class name of the event. Using the example class above, the broadcast event would be <code>App\Events\ServerCreated</code>. You can customize this broadcast event name to whatever
                you want using the <code>broadcastAs</code> method:</p>
            <pre><code>/**
 * Get the broadcast event name.
 *
 * @return string
 */
public function broadcastAs()
{
    return 'app.server-created';
}
</code></pre>
            <p>
                <a name="broadcast-data"></a>
            </p>
            <h3>Broadcast Data</h3>
            <p>When an event is broadcast, all of its <code>public</code> properties are automatically serialized and broadcast as the event's payload, allowing you to access any of its public data from your JavaScript application. So, for example, if your
                event has a single public <code>$user</code> property that contains an Eloquent model, the broadcast payload would be:</p>
            <pre><code>{
    &quot;user&quot;: {
        &quot;id&quot;: 1,
        &quot;name&quot;: &quot;Jonathan Banks&quot;
        ...
    }
}
</code></pre>
            <p>However, if you wish to have even more fine-grained control over your broadcast payload, you may add a <code>broadcastWith</code> method to your event. This method should return the array of data that you wish to broadcast with the event:</p>
            <pre><code>/**
 * Get the data to broadcast.
 *
 * @return array
 */
public function broadcastWith()
{
    return ['user' =&gt; $this-&gt;user-&gt;id];
}
</code></pre>
            <p>
                <a name="consuming-event-broadcasts"></a>
            </p>
            <h3>Consuming Event Broadcasts</h3>
            <h4>Pusher</h4>
            <p>You may conveniently consume events broadcast using the <a href="https://pusher.com" target="_blank">Pusher</a> driver using Pusher's JavaScript SDK. For example, let's consume the <code>App\Events\ServerCreated</code> event from our previous examples:</p>
            <pre><code>this.pusher = new Pusher('pusher-key');

this.pusherChannel = this.pusher.subscribe('user.' + USER_ID);

this.pusherChannel.bind('App\\Events\\ServerCreated', function(message) {
    console.log(message.user);
});
</code></pre>
            <h4>Redis</h4>
            <p>If you are using the Redis broadcaster, you will need to write your own Redis pub/sub consumer to receive the messages and broadcast them using the websocket technology of your choice. For example, you may choose to use the popular <a href="http://socket.io" target="_blank">Socket.io</a>                library which is written in Node.</p>
            <p>Using the <code>socket.io</code> and <code>ioredis</code> Node libraries, you can quickly write an event broadcaster to publish all events that are broadcast by your Laravel application:</p>
            <pre><code>var app = require('http').createServer(handler);
var io = require('socket.io')(app);

var Redis = require('ioredis');
var redis = new Redis();

app.listen(6001, function() {
    console.log('Server is running!');
});

function handler(req, res) {
    res.writeHead(200);
    res.end('');
}

io.on('connection', function(socket) {
    //
});

redis.psubscribe('*', function(err, count) {
    //
});

redis.on('pmessage', function(subscribed, channel, message) {
    message = JSON.parse(message);
    io.emit(channel + ':' + message.event, message.data);
});
</code></pre>
            <p>
                <a name="event-subscribers"></a>
            </p>
            <h2>Event Subscribers</h2>
            <p>Event subscribers are classes that may subscribe to multiple events from within the class itself, allowing you to define several event handlers within a single class. Subscribers should define a <code>subscribe</code> method, which will be
                passed an event dispatcher instance:</p>
            <pre><code>&lt;?php

namespace App\Listeners;

class UserEventListener
{
    /**
     * Handle user login events.
     */
    public function onUserLogin($event) {}

    /**
     * Handle user logout events.
     */
    public function onUserLogout($event) {}

    /**
     * Register the listeners for the subscriber.
     *
     * @param  Illuminate\Events\Dispatcher  $events
     */
    public function subscribe($events)
    {
        $events-&gt;listen(
            'App\Events\UserLoggedIn',
            'App\Listeners\UserEventListener@onUserLogin'
        );

        $events-&gt;listen(
            'App\Events\UserLoggedOut',
            'App\Listeners\UserEventListener@onUserLogout'
        );
    }

}
</code></pre>
            <h4>Registering An Event Subscriber</h4>
            <p>Once the subscriber has been defined, it may be registered with the event dispatcher. You may register subscribers using the <code>$subscribe</code> property on the <code>EventServiceProvider</code>. For example, let's add the <code>UserEventListener</code>.</p>
            <pre><code>&lt;?php

namespace App\Providers;

use Illuminate\Contracts\Events\Dispatcher as DispatcherContract;
use Illuminate\Foundation\Support\Providers\EventServiceProvider as ServiceProvider;

class EventServiceProvider extends ServiceProvider
{
    /**
     * The event listener mappings for the application.
     *
     * @var array
     */
    protected $listen = [
        //
    ];

    /**
     * The subscriber classes to register.
     *
     * @var array
     */
    protected $subscribe = [
        'App\Listeners\UserEventListener',
    ];
}
</code></pre>
            <p>
                <a name="framework-events"></a>
            </p>
            <h2>Framework Events</h2>
            <p>Laravel provides a variety of &quot;core&quot; events for actions performed by the framework. You can subscribe to them in the same way that you subscribe to your own custom events:</p>
            <table>
                <thead>
                    <tr>
                        <th>Event</th>
                        <th>Parameter(s)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>artisan.start</td>
                        <td>$application</td>
                    </tr>
                    <tr>
                        <td>auth.attempt</td>
                        <td>$credentials, $remember, $login</td>
                    </tr>
                    <tr>
                        <td>auth.login</td>
                        <td>$user, $remember</td>
                    </tr>
                    <tr>
                        <td>auth.logout</td>
                        <td>$user</td>
                    </tr>
                    <tr>
                        <td>cache.missed</td>
                        <td>$key</td>
                    </tr>
                    <tr>
                        <td>cache.hit</td>
                        <td>$key, $value</td>
                    </tr>
                    <tr>
                        <td>cache.write</td>
                        <td>$key, $value, $minutes</td>
                    </tr>
                    <tr>
                        <td>cache.delete</td>
                        <td>$key</td>
                    </tr>
                    <tr>
                        <td>connection.{name}.beginTransaction</td>
                        <td>$connection</td>
                    </tr>
                    <tr>
                        <td>connection.{name}.committed</td>
                        <td>$connection</td>
                    </tr>
                    <tr>
                        <td>connection.{name}.rollingBack</td>
                        <td>$connection</td>
                    </tr>
                    <tr>
                        <td>illuminate.query</td>
                        <td>$query, $bindings, $time, $connectionName</td>
                    </tr>
                    <tr>
                        <td>illuminate.queue.after</td>
                        <td>$connection, $job, $data</td>
                    </tr>
                    <tr>
                        <td>illuminate.queue.failed</td>
                        <td>$connection, $job, $data</td>
                    </tr>
                    <tr>
                        <td>illuminate.queue.stopping</td>
                        <td>null</td>
                    </tr>
                    <tr>
                        <td>mailer.sending</td>
                        <td>$message</td>
                    </tr>
                    <tr>
                        <td>router.matched</td>
                        <td>$route, $request</td>
                    </tr>
                    <tr>
                        <td>composing:{view name}</td>
                        <td>$view</td>
                    </tr>
                    <tr>
                        <td>creating:{view name}</td>
                        <td>$view</td>
                    </tr>
                </tbody>
            </table>

        </article>
    </div>


    <footer class="main">
        <ul>
            <li class="nav-docs"><a href="http://www.golaravel.com/laravel/docs/">中文文档</a>
            </li>
            <li class="nav-community"><a href="http://wenda.golaravel.com" target="_blank">问答社区</a>
            </li>
            <li class="nav-api"><a href="http://laravel.com/api/5.0/" target="_blank">API</a>
            </li>
            <li class="nav-laracasts"><a href="https://laracasts.com" target="_blank">视频教程（国外）</a>
            </li>
            <li class="nav-forge"><a href="https://forge.laravel.com" target="_blank">Forge</a>
            </li>

        </ul>
        <p>Laravel is a trademark of Taylor Otwell. Copyright &copy; Taylor Otwell.</p>
        <p class="less-significant"><a href="http://jackmcdade.com" target="_blank">Design by Jack McDade</a>
        </p>
    </footer>

    <script src="../../assets/js/laravel.js"></script>
    <script src="../../assets/js/viewport-units-buggyfill.js"></script>
    <script>
        window.viewportUnitsBuggyfill.init();
    </script>
    <script type="text/javascript">
        var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
        document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fc8d13872a523d9c286aa7affbe0921f1' type='text/javascript'%3E%3C/script%3E"));
    </script>
</body>

</html>