<!doctype html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <title>Authentication - Laravel 5.1 中文文档 | Laravel 中文网</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Laravel 中文网">
    <meta name="description" content="Laravel - 为 WEB 艺术家创造的 PHP 框架。| Laravel 中文网">
    <meta name="keywords" content="Laravel中文社区,php框架,laravel中文网,php framework,restful routing,laravel,laravel php">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--[if lte IE 9]>
		<script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../../assets/css/laravel.css">
    <link rel="stylesheet" href="../../assets/css/patch.css">
</head>

<body class="docs language-php">

    <span class="overlay"></span>

    <nav class="main">
        <div class="container">
            <a href="http://www.golaravel.com/laravel/" class="brand">
                <img src="../../assets/img/laravel-logo.png" height="30"> Laravel
            </a>

            <div class="responsive-sidebar-nav">
                <a href="authentication#" class="toggle-slide menu-link btn">&#9776;</a>
            </div>

            <div class="switcher">
                <div class="dropdown">
                    <button class="btn dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
                        <!--<span class="faint">v</span> -->
                        5.1
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                        <li role="presentation">
                            <a role="menuitem" tabindex="-1" href="index.html">5.1</a>
                        </li>
                        <li role="presentation">
                            <a role="menuitem" tabindex="-1" href="http://www.golaravel.com/laravel/docs/5.0">5.0</a>
                        </li>
                        <li role="presentation">
                            <a role="menuitem" tabindex="-1" href="http://www.golaravel.com/laravel/docs/4.2">4.2</a>
                        </li>
                        <li role="presentation">
                            <a role="menuitem" tabindex="-1" href="http://www.golaravel.com/laravel/docs/4.1">4.1</a>
                        </li>
                        <li role="presentation">
                            <a role="menuitem" tabindex="-1" href="http://www.golaravel.com/laravel/docs/4.0">4.0</a>
                        </li>
                    </ul>
                </div>
            </div>

            <ul class="main-nav">
                <li class="nav-docs"><a href="http://www.golaravel.com/laravel/docs/">中文文档</a>
                </li>
                <li class="nav-community"><a href="http://wenda.golaravel.com" target="_blank">问答社区</a>
                </li>
                <li class="nav-api"><a href="http://laravel.com/api/5.0/" target="_blank">API</a>
                </li>
                <li class="nav-laracasts"><a href="https://laracasts.com" target="_blank">视频教程（国外）</a>
                </li>
                <li class="nav-forge"><a href="https://forge.laravel.com" target="_blank">Forge</a>
                </li>

            </ul>
        </div>
    </nav>

    <nav id="slide-menu" class="slide-menu" role="navigation">

        <div class="brand">
            <a href="http://www.golaravel.com/laravel/">
                <img src="../../assets/img/laravel-logo-white.png" height="50">
            </a>
        </div>

        <ul class="slide-main-nav">
            <li><a href="http://www.golaravel.com/laravel/">首页</a>
            </li>
            <li class="nav-docs"><a href="http://www.golaravel.com/laravel/docs/">中文文档</a>
            </li>
            <li class="nav-community"><a href="http://wenda.golaravel.com" target="_blank">问答社区</a>
            </li>
            <li class="nav-api"><a href="http://laravel.com/api/5.0/" target="_blank">API</a>
            </li>
            <li class="nav-laracasts"><a href="https://laracasts.com" target="_blank">视频教程（国外）</a>
            </li>
            <li class="nav-forge"><a href="https://forge.laravel.com" target="_blank">Forge</a>
            </li>

        </ul>

        <div class="slide-docs-nav">
            <h2>文档目录</h2>
            <ul>
                <li>序言
                    <ul>
                        <li><a href="releases">版本说明</a>
                        </li>
                        <li><a href="upgrade">升级指南</a>
                        </li>
                        <li><a href="contributions">贡献指南</a>
                        </li>
                        <li><a href="http://www.golaravel.com/laravel/api/5.1">API 文档</a>
                        </li>
                    </ul>
                </li>
                <li>安装设置
                    <ul>
                        <li><a href="installation">安装</a>
                        </li>
                        <li><a href="homestead">Homestead</a>
                        </li>
                    </ul>
                </li>
                <li>教程
                    <ul>
                        <li><a href="quickstart">入门学习任务</a>
                        </li>
                        <li><a href="quickstart-intermediate">中级学习任务</a>
                        </li>
                    </ul>
                </li>
                <li>基础知识
                    <ul>
                        <li><a href="routing">路由</a>
                        </li>
                        <li><a href="middleware">中间件</a>
                        </li>
                        <li><a href="controllers">控制器</a>
                        </li>
                        <li><a href="requests">请求</a>
                        </li>
                        <li><a href="responses">响应</a>
                        </li>
                        <li><a href="views">视图</a>
                        </li>
                        <li><a href="blade">Blade 模板</a>
                        </li>
                    </ul>
                </li>
                <li>系统架构
                    <ul>
                        <li><a href="lifecycle">请求的生命周期</a>
                        </li>
                        <li><a href="structure">应用程序结构</a>
                        </li>
                        <li><a href="providers">服务提供者</a>
                        </li>
                        <li><a href="container">服务容器</a>
                        </li>
                        <li><a href="contracts">Contract</a>
                        </li>
                        <li><a href="facades">Facade</a>
                        </li>
                    </ul>
                </li>
                <li>系统服务
                    <ul>
                        <li><a href="authentication">认证</a>
                        </li>
                        <li><a href="authorization">授权</a>
                        </li>
                        <li><a href="artisan">Artisan 控制台</a>
                        </li>
                        <li><a href="billing">计费</a>
                        </li>
                        <li><a href="cache">缓存</a>
                        </li>
                        <li><a href="collections">集合</a>
                        </li>
                        <li><a href="elixir">Elixir</a>
                        </li>
                        <li><a href="encryption">加密</a>
                        </li>
                        <li><a href="errors">错误与日志</a>
                        </li>
                        <li><a href="events">事件</a>
                        </li>
                        <li><a href="filesystem">文件系统 / 云存储</a>
                        </li>
                        <li><a href="hashing">哈希</a>
                        </li>
                        <li><a href="helpers">辅助方法</a>
                        </li>
                        <li><a href="localization">本地化</a>
                        </li>
                        <li><a href="mail">邮件</a>
                        </li>
                        <li><a href="packages">扩展包开发</a>
                        </li>
                        <li><a href="pagination">分页</a>
                        </li>
                        <li><a href="queues">队列</a>
                        </li>
                        <li><a href="redis">Redis</a>
                        </li>
                        <li><a href="session">会话</a>
                        </li>
                        <li><a href="envoy">SSH 任务</a>
                        </li>
                        <li><a href="scheduling">任务调度</a>
                        </li>
                        <li><a href="testing">测试</a>
                        </li>
                        <li><a href="validation">验证</a>
                        </li>
                    </ul>
                </li>
                <li>数据库
                    <ul>
                        <li><a href="database">入门</a>
                        </li>
                        <li><a href="queries">查询构造器</a>
                        </li>
                        <li><a href="migrations">迁移</a>
                        </li>
                        <li><a href="seeding">数据填充</a>
                        </li>
                    </ul>
                </li>
                <li>Eloquent ORM
                    <ul>
                        <li><a href="eloquent">入门</a>
                        </li>
                        <li><a href="eloquent-relationships">关系</a>
                        </li>
                        <li><a href="eloquent-collections">集合</a>
                        </li>
                        <li><a href="eloquent-mutators">调整修改</a>
                        </li>
                        <li><a href="eloquent-serialization">序列化</a>
                        </li>
                    </ul>
                </li>
            </ul>

        </div>

    </nav>

    <div class="docs-wrapper container">

        <section class="sidebar">
            <ul>
                <li>序言
                    <ul>
                        <li><a href="releases">版本说明</a>
                        </li>
                        <li><a href="upgrade">升级指南</a>
                        </li>
                        <li><a href="contributions">贡献指南</a>
                        </li>
                        <li><a href="http://www.golaravel.com/laravel/api/5.1">API 文档</a>
                        </li>
                    </ul>
                </li>
                <li>安装设置
                    <ul>
                        <li><a href="installation">安装</a>
                        </li>
                        <li><a href="homestead">Homestead</a>
                        </li>
                    </ul>
                </li>
                <li>教程
                    <ul>
                        <li><a href="quickstart">入门学习任务</a>
                        </li>
                        <li><a href="quickstart-intermediate">中级学习任务</a>
                        </li>
                    </ul>
                </li>
                <li>基础知识
                    <ul>
                        <li><a href="routing">路由</a>
                        </li>
                        <li><a href="middleware">中间件</a>
                        </li>
                        <li><a href="controllers">控制器</a>
                        </li>
                        <li><a href="requests">请求</a>
                        </li>
                        <li><a href="responses">响应</a>
                        </li>
                        <li><a href="views">视图</a>
                        </li>
                        <li><a href="blade">Blade 模板</a>
                        </li>
                    </ul>
                </li>
                <li>系统架构
                    <ul>
                        <li><a href="lifecycle">请求的生命周期</a>
                        </li>
                        <li><a href="structure">应用程序结构</a>
                        </li>
                        <li><a href="providers">服务提供者</a>
                        </li>
                        <li><a href="container">服务容器</a>
                        </li>
                        <li><a href="contracts">Contract</a>
                        </li>
                        <li><a href="facades">Facade</a>
                        </li>
                    </ul>
                </li>
                <li>系统服务
                    <ul>
                        <li><a href="authentication">认证</a>
                        </li>
                        <li><a href="authorization">授权</a>
                        </li>
                        <li><a href="artisan">Artisan 控制台</a>
                        </li>
                        <li><a href="billing">计费</a>
                        </li>
                        <li><a href="cache">缓存</a>
                        </li>
                        <li><a href="collections">集合</a>
                        </li>
                        <li><a href="elixir">Elixir</a>
                        </li>
                        <li><a href="encryption">加密</a>
                        </li>
                        <li><a href="errors">错误与日志</a>
                        </li>
                        <li><a href="events">事件</a>
                        </li>
                        <li><a href="filesystem">文件系统 / 云存储</a>
                        </li>
                        <li><a href="hashing">哈希</a>
                        </li>
                        <li><a href="helpers">辅助方法</a>
                        </li>
                        <li><a href="localization">本地化</a>
                        </li>
                        <li><a href="mail">邮件</a>
                        </li>
                        <li><a href="packages">扩展包开发</a>
                        </li>
                        <li><a href="pagination">分页</a>
                        </li>
                        <li><a href="queues">队列</a>
                        </li>
                        <li><a href="redis">Redis</a>
                        </li>
                        <li><a href="session">会话</a>
                        </li>
                        <li><a href="envoy">SSH 任务</a>
                        </li>
                        <li><a href="scheduling">任务调度</a>
                        </li>
                        <li><a href="testing">测试</a>
                        </li>
                        <li><a href="validation">验证</a>
                        </li>
                    </ul>
                </li>
                <li>数据库
                    <ul>
                        <li><a href="database">入门</a>
                        </li>
                        <li><a href="queries">查询构造器</a>
                        </li>
                        <li><a href="migrations">迁移</a>
                        </li>
                        <li><a href="seeding">数据填充</a>
                        </li>
                    </ul>
                </li>
                <li>Eloquent ORM
                    <ul>
                        <li><a href="eloquent">入门</a>
                        </li>
                        <li><a href="eloquent-relationships">关系</a>
                        </li>
                        <li><a href="eloquent-collections">集合</a>
                        </li>
                        <li><a href="eloquent-mutators">调整修改</a>
                        </li>
                        <li><a href="eloquent-serialization">序列化</a>
                        </li>
                    </ul>
                </li>
            </ul>

        </section>

        <article>
            <h1>Authentication</h1>
            <ul>
                <li><a href="authentication#introduction">Introduction</a>
                </li>
                <li><a href="authentication#authentication-quickstart">Authentication Quickstart</a>
                    <ul>
                        <li><a href="authentication#included-routing">Routing</a>
                        </li>
                        <li><a href="authentication#included-views">Views</a>
                        </li>
                        <li><a href="authentication#included-authenticating">Authenticating</a>
                        </li>
                        <li><a href="authentication#retrieving-the-authenticated-user">Retrieving The Authenticated User</a>
                        </li>
                        <li><a href="authentication#protecting-routes">Protecting Routes</a>
                        </li>
                        <li><a href="authentication#authentication-throttling">Authentication Throttling</a>
                        </li>
                    </ul>
                </li>
                <li><a href="authentication#authenticating-users">Manually Authenticating Users</a>
                    <ul>
                        <li><a href="authentication#remembering-users">Remembering Users</a>
                        </li>
                        <li><a href="authentication#other-authentication-methods">Other Authentication Methods</a>
                        </li>
                    </ul>
                </li>
                <li><a href="authentication#http-basic-authentication">HTTP Basic Authentication</a>
                    <ul>
                        <li><a href="authentication#stateless-http-basic-authentication">Stateless HTTP Basic Authentication</a>
                        </li>
                    </ul>
                </li>
                <li><a href="authentication#resetting-passwords">Resetting Passwords</a>
                    <ul>
                        <li><a href="authentication#resetting-database">Database Considerations</a>
                        </li>
                        <li><a href="authentication#resetting-routing">Routing</a>
                        </li>
                        <li><a href="authentication#resetting-views">Views</a>
                        </li>
                        <li><a href="authentication#after-resetting-passwords">After Resetting Passwords</a>
                        </li>
                    </ul>
                </li>
                <li><a href="authentication#social-authentication">Social Authentication</a>
                </li>
                <li><a href="authentication#adding-custom-authentication-drivers">Adding Custom Authentication Drivers</a>
                </li>
                <li><a href="authentication#events">Events</a>
                </li>
            </ul>
            <p>
                <a name="introduction"></a>
            </p>
            <h2>Introduction</h2>
            <p>Laravel makes implementing authentication very simple. In fact, almost everything is configured for you out of the box. The authentication configuration file is located at <code>config/auth.php</code>, which contains several well documented
                options for tweaking the behavior of the authentication services.</p>
            <h3>Database Considerations</h3>
            <p>By default, Laravel includes an <code>App\User</code> <a href="eloquent">Eloquent model</a> in your <code>app</code> directory. This model may be used with the default Eloquent authentication driver. If your application is not using
                Eloquent, you may use the <code>database</code> authentication driver which uses the Laravel query builder.</p>
            <p>When building the database schema for the <code>App\User</code> model, make sure the password column is at least 60 characters in length.</p>
            <p>Also, you should verify that your <code>users</code> (or equivalent) table contains a nullable, string <code>remember_token</code> column of 100 characters. This column will be used to store a token for &quot;remember me&quot; sessions being
                maintained by your application. This can be done by using <code>$table-&gt;rememberToken();</code> in a migration.</p>
            <p>
                <a name="authentication-quickstart"></a>
            </p>
            <h2>Authentication Quickstart</h2>
            <p>Laravel ships with two authentication controllers out of the box, which are located in the <code>App\Http\Controllers\Auth</code> namespace. The <code>AuthController</code> handles new user registration and authentication, while the <code>PasswordController</code>                contains the logic to help existing users reset their forgotten passwords. Each of these controllers uses a trait to include their necessary methods. For many applications, you will not need to modify these controllers at all.</p>
            <p>
                <a name="included-routing"></a>
            </p>
            <h3>Routing</h3>
            <p>By default, no <a href="routing">routes</a> are included to point requests to the authentication controllers. You may manually add them to your <code>app/Http/routes.php</code> file:</p>
            <pre><code>// Authentication routes...
Route::get('auth/login', 'Auth\AuthController@getLogin');
Route::post('auth/login', 'Auth\AuthController@postLogin');
Route::get('auth/logout', 'Auth\AuthController@getLogout');

// Registration routes...
Route::get('auth/register', 'Auth\AuthController@getRegister');
Route::post('auth/register', 'Auth\AuthController@postRegister');
</code></pre>
            <p>
                <a name="included-views"></a>
            </p>
            <h3>Views</h3>
            <p>Though the authentication controllers are included with the framework, you will need to provide <a href="views">views</a> that these controllers can render. The views should be placed in the <code>resources/views/auth</code> directory.
                You are free to customize these views however you wish. The login view should be placed at <code>resources/views/auth/login.blade.php</code>, and the registration view should be placed at <code>resources/views/auth/register.blade.php</code>.</p>
            <h4>Sample Authentication Form</h4>
            <pre><code>&lt;!-- resources/views/auth/login.blade.php --&gt;

&lt;form method=&quot;POST&quot; action=&quot;/auth/login&quot;&gt;
    {!! csrf_field() !!}

    &lt;div&gt;
        Email
        &lt;input type=&quot;email&quot; name=&quot;email&quot; value=&quot;{{ old('email') }}&quot;&gt;
    &lt;/div&gt;

    &lt;div&gt;
        Password
        &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot;&gt;
    &lt;/div&gt;

    &lt;div&gt;
        &lt;input type=&quot;checkbox&quot; name=&quot;remember&quot;&gt; Remember Me
    &lt;/div&gt;

    &lt;div&gt;
        &lt;button type=&quot;submit&quot;&gt;Login&lt;/button&gt;
    &lt;/div&gt;
&lt;/form&gt;
</code></pre>
            <h4>Sample Registration Form</h4>
            <pre><code>&lt;!-- resources/views/auth/register.blade.php --&gt;

&lt;form method=&quot;POST&quot; action=&quot;/auth/register&quot;&gt;
    {!! csrf_field() !!}

    &lt;div&gt;
        Name
        &lt;input type=&quot;text&quot; name=&quot;name&quot; value=&quot;{{ old('name') }}&quot;&gt;
    &lt;/div&gt;

    &lt;div&gt;
        Email
        &lt;input type=&quot;email&quot; name=&quot;email&quot; value=&quot;{{ old('email') }}&quot;&gt;
    &lt;/div&gt;

    &lt;div&gt;
        Password
        &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;
    &lt;/div&gt;

    &lt;div&gt;
        Confirm Password
        &lt;input type=&quot;password&quot; name=&quot;password_confirmation&quot;&gt;
    &lt;/div&gt;

    &lt;div&gt;
        &lt;button type=&quot;submit&quot;&gt;Register&lt;/button&gt;
    &lt;/div&gt;
&lt;/form&gt;
</code></pre>
            <p>
                <a name="included-authenticating"></a>
            </p>
            <h3>Authenticating</h3>
            <p>Now that you have routes and views setup for the included authentication controllers, you are ready to register and authenticate new users for your application. You may simply access your defined routes in a browser. The authentication controllers
                already contain the logic (via their traits) to authenticate existing users and store new users in the database.</p>
            <p>When a user is successfully authenticated, they will be redirected to the <code>/home</code> URI, which you will need to register a route to handle. You can customize the post-authentication redirect location by defining a <code>redirectPath</code>                property on the <code>AuthController</code>:</p>
            <pre><code>protected $redirectPath = '/dashboard';
</code></pre>
            <p>When a user is not successfully authenticated, they will be redirected to the <code>/auth/login</code> URI. You can customize the failed post-authentication redirect location by defining a <code>loginPath</code> property on the <code>AuthController</code>:</p>
            <pre><code>protected $loginPath = '/login';
</code></pre>
            <p>The <code>loginPath</code> will not change where a user is bounced if they try to access a protected route. That is controlled by the <code>App\Http\Middleware\Authenticate</code> middleware's <code>handle</code> method.</p>
            <h4>Customizations</h4>
            <p>To modify the form fields that are required when a new user registers with your application, or to customize how new user records are inserted into your database, you may modify the <code>AuthController</code> class. This class is responsible
                for validating and creating new users of your application.</p>
            <p>The <code>validator</code> method of the <code>AuthController</code> contains the validation rules for new users of the application. You are free to modify this method as you wish.</p>
            <p>The <code>create</code> method of the <code>AuthController</code> is responsible for creating new <code>App\User</code> records in your database using the <a href="eloquent">Eloquent ORM</a>. You are free to modify this method according
                to the needs of your database.</p>
            <p>
                <a name="retrieving-the-authenticated-user"></a>
            </p>
            <h3>Retrieving The Authenticated User</h3>
            <p>You may access the authenticated user via the <code>Auth</code> facade:</p>
            <pre><code>$user = Auth::user();
</code></pre>
            <p>Alternatively, once a user is authenticated, you may access the authenticated user via an <code>Illuminate\Http\Request</code> instance:</p>
            <pre><code>&lt;?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Routing\Controller;

class ProfileController extends Controller
{
    /**
     * Update the user's profile.
     *
     * @param  Request  $request
     * @return Response
     */
    public function updateProfile(Request $request)
    {
        if ($request-&gt;user()) {
            // $request-&gt;user() returns an instance of the authenticated user...
        }
    }
}
</code></pre>
            <h4>Determining If The Current User Is Authenticated</h4>
            <p>To determine if the user is already logged into your application, you may use the <code>check</code> method on the <code>Auth</code> facade, which will return <code>true</code> if the user is authenticated:</p>
            <pre><code>if (Auth::check()) {
    // The user is logged in...
}
</code></pre>
            <p>However, you may use middleware to verify that the user is authenticated before allowing the user access to certain routes / controllers. To learn more about this, check out the documentation on <a href="authentication#protecting-routes">protecting routes</a>.</p>
            <p>
                <a name="protecting-routes"></a>
            </p>
            <h3>Protecting Routes</h3>
            <p><a href="middleware">Route middleware</a> can be used to allow only authenticated users to access a given route. Laravel ships with the <code>auth</code> middleware, which is defined in <code>app\Http\Middleware\Authenticate.php</code>.
                All you need to do is attach the middleware to a route definition:</p>
            <pre><code>// Using A Route Closure...

Route::get('profile', ['middleware' =&gt; 'auth', function() {
    // Only authenticated users may enter...
}]);

// Using A Controller...

Route::get('profile', [
    'middleware' =&gt; 'auth',
    'uses' =&gt; 'ProfileController@show'
]);
</code></pre>
            <p>Of course, if you are using <a href="controllers">controller classes</a>, you may call the <code>middleware</code> method from the controller's constructor instead of attaching it in the route definition directly:</p>
            <pre><code>public function __construct()
{
    $this-&gt;middleware('auth');
}
</code></pre>
            <p>
                <a name="authentication-throttling"></a>
            </p>
            <h3>Authentication Throttling</h3>
            <p>If you are using Laravel's built-in <code>AuthController</code> class, the <code>Illuminate\Foundation\Auth\ThrottlesLogins</code> trait may be used to throttle login attempts to your application. By default, the user will not be able to login
                for one minute if they fail to provide the correct credentials after several attempts. The throttling is unique to the user's username / e-mail address and their IP address:</p>
            <pre><code>&lt;?php

namespace App\Http\Controllers\Auth;

use App\User;
use Validator;
use App\Http\Controllers\Controller;
use Illuminate\Foundation\Auth\ThrottlesLogins;
use Illuminate\Foundation\Auth\AuthenticatesAndRegistersUsers;

class AuthController extends Controller
{
    use AuthenticatesAndRegistersUsers, ThrottlesLogins;

    // Rest of AuthController class...
}
</code></pre>
            <p>
                <a name="authenticating-users"></a>
            </p>
            <h2>Manually Authenticating Users</h2>
            <p>Of course, you are not required to use the authentication controllers included with Laravel. If you choose to remove these controllers, you will need to manage user authentication using the Laravel authentication classes directly. Don't worry,
                it's a cinch!</p>
            <p>We will access Laravel's authentication services via the <code>Auth</code> <a href="facades">facade</a>, so we'll need to make sure to import the <code>Auth</code> facade at the top of the class. Next, let's check out the <code>attempt</code>                method:</p>
            <pre><code>&lt;?php

namespace App\Http\Controllers;

use Auth;
use Illuminate\Routing\Controller;

class AuthController extends Controller
{
    /**
     * Handle an authentication attempt.
     *
     * @return Response
     */
    public function authenticate()
    {
        if (Auth::attempt(['email' =&gt; $email, 'password' =&gt; $password])) {
            // Authentication passed...
            return redirect()-&gt;intended('dashboard');
        }
    }
}
</code></pre>
            <p>The <code>attempt</code> method accepts an array of key / value pairs as its first argument. The values in the array will be used to find the user in your database table. So, in the example above, the user will be retrieved by the value of
                the <code>email</code> column. If the user is found, the hashed password stored in the database will be compared with the hashed <code>password</code> value passed to the method via the array. If the two hashed passwords match an authenticated
                session will be started for the user.</p>
            <p>The <code>attempt</code> method will return <code>true</code> if authentication was successful. Otherwise, <code>false</code> will be returned.</p>
            <p>The <code>intended</code> method on the redirector will redirect the user to the URL they were attempting to access before being caught by the authentication filter. A fallback URI may be given to this method in case the intended destination
                is not available.</p>
            <p>If you wish, you also may add extra conditions to the authentication query in addition to the user's e-mail and password. For example, we may verify that user is marked as &quot;active&quot;:</p>
            <pre><code>if (Auth::attempt(['email' =&gt; $email, 'password' =&gt; $password, 'active' =&gt; 1])) {
    // The user is active, not suspended, and exists.
}
</code></pre>
            <p>To log users out of your application, you may use the <code>logout</code> method on the <code>Auth</code> facade. This will clear the authentication information in the user's session:</p>
            <pre><code>Auth::logout();
</code></pre>
            <blockquote>
                <p><strong>Note:</strong> In these examples, <code>email</code> is not a required option, it is merely used as an example. You should use whatever column name corresponds to a &quot;username&quot; in your database.</p>
            </blockquote>
            <p>
                <a name="remembering-users"></a>
            </p>
            <h2>Remembering Users</h2>
            <p>If you would like to provide &quot;remember me&quot; functionality in your application, you may pass a boolean value as the second argument to the <code>attempt</code> method, which will keep the user authenticated indefinitely, or until they
                manually logout. Of course, your <code>users</code> table must include the string <code>remember_token</code> column, which will be used to store the &quot;remember me&quot; token.</p>
            <pre><code>if (Auth::attempt(['email' =&gt; $email, 'password' =&gt; $password], $remember)) {
    // The user is being remembered...
}
</code></pre>
            <p>If you are &quot;remembering&quot; users, you may use the <code>viaRemember</code> method to determine if the user was authenticated using the &quot;remember me&quot; cookie:</p>
            <pre><code>if (Auth::viaRemember()) {
    //
}
</code></pre>
            <p>
                <a name="other-authentication-methods"></a>
            </p>
            <h3>Other Authentication Methods</h3>
            <h4>Authenticate A User Instance</h4>
            <p>If you need to log an existing user instance into your application, you may call the <code>login</code> method with the user instance. The given object must be an implementation of the <code>Illuminate\Contracts\Auth\Authenticatable</code>                <a href="contracts">contract</a>. Of course, the <code>App\User</code> model included with Laravel already implements this interface:</p>
            <pre><code>Auth::login($user);
</code></pre>
            <h4>Authenticate A User By ID</h4>
            <p>To log a user into the application by their ID, you may use the <code>loginUsingId</code> method. This method simply accepts the primary key of the user you wish to authenticate:</p>
            <pre><code>Auth::loginUsingId(1);
</code></pre>
            <h4>Authenticate A User Once</h4>
            <p>You may use the <code>once</code> method to log a user into the application for a single request. No sessions or cookies will be utilized, which may be helpful when building a stateless API. The <code>once</code> method has the same signature
                as the <code>attempt</code> method:</p>
            <pre><code>if (Auth::once($credentials)) {
    //
}
</code></pre>
            <p>
                <a name="http-basic-authentication"></a>
            </p>
            <h2>HTTP Basic Authentication</h2>
            <p><a href="http://en.wikipedia.org/wiki/Basic_access_authentication" target="_blank">HTTP Basic Authentication</a> provides a quick way to authenticate users of your application without setting up a dedicated &quot;login&quot; page. To get started, attach the
                <code>auth.basic</code> <a href="middleware">middleware</a> to your route. The <code>auth.basic</code> middleware is included with the Laravel framework, so you do not need to define it:</p>
            <pre><code>Route::get('profile', ['middleware' =&gt; 'auth.basic', function() {
    // Only authenticated users may enter...
}]);
</code></pre>
            <p>Once the middleware has been attached to the route, you will automatically be prompted for credentials when accessing the route in your browser. By default, the <code>auth.basic</code> middleware will use the <code>email</code> column on the
                user record as the &quot;username&quot;.</p>
            <h4>A Note On FastCGI</h4>
            <p>If you are using PHP FastCGI, HTTP Basic authentication may not work correctly out of the box. The following lines should be added to your <code>.htaccess</code> file:</p>
            <pre><code>RewriteCond %{HTTP:Authorization} ^(.+)$
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
</code></pre>
            <p>
                <a name="stateless-http-basic-authentication"></a>
            </p>
            <h3>Stateless HTTP Basic Authentication</h3>
            <p>You may also use HTTP Basic Authentication without setting a user identifier cookie in the session, which is particularly useful for API authentication. To do so, <a href="middleware">define a middleware</a> that calls the <code>onceBasic</code>                method. If no response is returned by the <code>onceBasic</code> method, the request may be passed further into the application:</p>
            <pre><code>&lt;?php

namespace Illuminate\Auth\Middleware;

use Auth;
use Closure;

class AuthenticateOnceWithBasicAuth
{
    /**
     * Handle an incoming request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  \Closure  $next
     * @return mixed
     */
    public function handle($request, Closure $next)
    {
        return Auth::onceBasic() ?: $next($request);
    }

}
</code></pre>
            <p>Next, <a href="middleware#registering-middleware">register the route middleware</a> and attach it to a route:</p>
            <pre><code>Route::get('api/user', ['middleware' =&gt; 'auth.basic.once', function() {
    // Only authenticated users may enter...
}]);
</code></pre>
            <p>
                <a name="resetting-passwords"></a>
            </p>
            <h2>Resetting Passwords</h2>
            <p>
                <a name="resetting-database"></a>
            </p>
            <h3>Database Considerations</h3>
            <p>Most web applications provide a way for users to reset their forgotten passwords. Rather than forcing you to re-implement this on each application, Laravel provides convenient methods for sending password reminders and performing password
                resets.</p>
            <p>To get started, verify that your <code>App\User</code> model implements the <code>Illuminate\Contracts\Auth\CanResetPassword</code> contract. Of course, the <code>App\User</code> model included with the framework already implements this interface,
                and uses the <code>Illuminate\Auth\Passwords\CanResetPassword</code> trait to include the methods needed to implement the interface.</p>
            <h4>Generating The Reset Token Table Migration</h4>
            <p>Next, a table must be created to store the password reset tokens. The migration for this table is included with Laravel out of the box, and resides in the <code>database/migrations</code> directory. So, all you need to do is migrate:</p>
            <pre><code>php artisan migrate
</code></pre>
            <p>
                <a name="resetting-routing"></a>
            </p>
            <h3>Routing</h3>
            <p>Laravel includes an <code>Auth\PasswordController</code> that contains the logic necessary to reset user passwords. However, you will need to define routes to point requests to this controller:</p>
            <pre><code>// Password reset link request routes...
Route::get('password/email', 'Auth\PasswordController@getEmail');
Route::post('password/email', 'Auth\PasswordController@postEmail');

// Password reset routes...
Route::get('password/reset/{token}', 'Auth\PasswordController@getReset');
Route::post('password/reset', 'Auth\PasswordController@postReset');
</code></pre>
            <p>
                <a name="resetting-views"></a>
            </p>
            <h3>Views</h3>
            <p>In addition to defining the routes for the <code>PasswordController</code>, you will need to provide views that can be returned by this controller. Don't worry, we will provide sample views to help you get started. Of course, you are free
                to style your forms however you wish.</p>
            <h4>Sample Password Reset Link Request Form</h4>
            <p>You will need to provide an HTML view for the password reset request form. This view should be placed at <code>resources/views/auth/password.blade.php</code>. This form provides a single field for the user's e-mail address, allowing them to
                request a password reset link:</p>
            <pre><code>&lt;!-- resources/views/auth/password.blade.php --&gt;

&lt;form method=&quot;POST&quot; action=&quot;/password/email&quot;&gt;
    {!! csrf_field() !!}

    @if (count($errors) &gt; 0)
        &lt;ul&gt;
            @foreach ($errors-&gt;all() as $error)
                &lt;li&gt;{{ $error }}&lt;/li&gt;
            @endforeach
        &lt;/ul&gt;
    @endif

    &lt;div&gt;
        Email
        &lt;input type=&quot;email&quot; name=&quot;email&quot; value=&quot;{{ old('email') }}&quot;&gt;
    &lt;/div&gt;

    &lt;div&gt;
        &lt;button type=&quot;submit&quot;&gt;
            Send Password Reset Link
        &lt;/button&gt;
    &lt;/div&gt;
&lt;/form&gt;
</code></pre>
            <p>When a user submits a request to reset their password, they will receive an e-mail with a link that points to the <code>getReset</code> method (typically routed at <code>/password/reset</code>) of the <code>PasswordController</code>. You will
                need to create a view for this e-mail at <code>resources/views/emails/password.blade.php</code>. The view will receive the <code>$token</code> variable which contains the password reset token to match the user to the password reset request.
                Here is an example e-mail view to get you started:</p>
            <pre><code>&lt;!-- resources/views/emails/password.blade.php --&gt;

Click here to reset your password: {{ url('password/reset/'.$token) }}
</code></pre>
            <h4>Sample Password Reset Form</h4>
            <p>When the user clicks the e-mailed link to reset their password, they will be presented with a password reset form. This view should be placed at <code>resources/views/auth/reset.blade.php</code>.</p>
            <p>Here is a sample password reset form to get you started:</p>
            <pre><code>&lt;!-- resources/views/auth/reset.blade.php --&gt;

&lt;form method=&quot;POST&quot; action=&quot;/password/reset&quot;&gt;
    {!! csrf_field() !!}
    &lt;input type=&quot;hidden&quot; name=&quot;token&quot; value=&quot;{{ $token }}&quot;&gt;

    @if (count($errors) &gt; 0)
        &lt;ul&gt;
            @foreach ($errors-&gt;all() as $error)
                &lt;li&gt;{{ $error }}&lt;/li&gt;
            @endforeach
        &lt;/ul&gt;
    @endif

    &lt;div&gt;
        Email
        &lt;input type=&quot;email&quot; name=&quot;email&quot; value=&quot;{{ old('email') }}&quot;&gt;
    &lt;/div&gt;

    &lt;div&gt;
        Password
        &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;
    &lt;/div&gt;

    &lt;div&gt;
        Confirm Password
        &lt;input type=&quot;password&quot; name=&quot;password_confirmation&quot;&gt;
    &lt;/div&gt;

    &lt;div&gt;
        &lt;button type=&quot;submit&quot;&gt;
            Reset Password
        &lt;/button&gt;
    &lt;/div&gt;
&lt;/form&gt;
</code></pre>
            <p>
                <a name="after-resetting-passwords"></a>
            </p>
            <h3>After Resetting Passwords</h3>
            <p>Once you have defined the routes and views to reset your user's passwords, you may simply access the routes in your browser. The <code>PasswordController</code> included with the framework already includes the logic to send the password reset
                link e-mails as well as update passwords in the database.</p>
            <p>After the password is reset, the user will automatically be logged into the application and redirected to <code>/home</code>. You can customize the post password reset redirect location by defining a <code>redirectTo</code> property on the
                <code>PasswordController</code>:</p>
            <pre><code>protected $redirectTo = '/dashboard';
</code></pre>
            <blockquote>
                <p><strong>Note:</strong> By default, password reset tokens expire after one hour. You may change this via the <code>reminder.expire</code> option in your <code>config/auth.php</code> file.</p>
            </blockquote>
            <p>
                <a name="social-authentication"></a>
            </p>
            <h2>Social Authentication</h2>
            <p>In addition to typical, form based authentication, Laravel also provides a simple, convenient way to authenticate with OAuth providers using <a href="https://github.com/laravel/socialite" target="_blank">Laravel Socialite</a>. Socialite currently supports
                authentication with Facebook, Twitter, LinkedIn, Google, GitHub and Bitbucket.</p>
            <p>To get started with Socialite, add to your <code>composer.json</code> file as a dependency:</p>
            <pre><code>composer require laravel/socialite
</code></pre>
            <h3>Configuration</h3>
            <p>After installing the Socialite library, register the <code>Laravel\Socialite\SocialiteServiceProvider</code> in your <code>config/app.php</code> configuration file:</p>
            <pre><code>'providers' =&gt; [
    // Other service providers...

    Laravel\Socialite\SocialiteServiceProvider::class,
],
</code></pre>
            <p>Also, add the <code>Socialite</code> facade to the <code>aliases</code> array in your <code>app</code> configuration file:</p>
            <pre><code>'Socialite' =&gt; Laravel\Socialite\Facades\Socialite::class,
</code></pre>
            <p>You will also need to add credentials for the OAuth services your application utilizes. These credentials should be placed in your <code>config/services.php</code> configuration file, and should use the key <code>facebook</code>, <code>twitter</code>,
                <code>linkedin</code>, <code>google</code>, <code>github</code> or <code>bitbucket</code>, depending on the providers your application requires. For example:</p>
            <pre><code>'github' =&gt; [
    'client_id' =&gt; 'your-github-app-id',
    'client_secret' =&gt; 'your-github-app-secret',
    'redirect' =&gt; 'http://your-callback-url',
],
</code></pre>
            <h3>Basic Usage</h3>
            <p>Next, you are ready to authenticate users! You will need two routes: one for redirecting the user to the OAuth provider, and another for receiving the callback from the provider after authentication. We will access Socialite using the <code>Socialite</code>                <a href="facades">facade</a>:</p>
            <pre><code>&lt;?php

namespace App\Http\Controllers;

use Socialite;
use Illuminate\Routing\Controller;

class AuthController extends Controller
{
    /**
     * Redirect the user to the GitHub authentication page.
     *
     * @return Response
     */
    public function redirectToProvider()
    {
        return Socialite::driver('github')-&gt;redirect();
    }

    /**
     * Obtain the user information from GitHub.
     *
     * @return Response
     */
    public function handleProviderCallback()
    {
        $user = Socialite::driver('github')-&gt;user();

        // $user-&gt;token;
    }
}
</code></pre>
            <p>The <code>redirect</code> method takes care of sending the user to the OAuth provider, while the <code>user</code> method will read the incoming request and retrieve the user's information from the provider. Before redirecting the user, you
                may also set &quot;scopes&quot; on the request using the <code>scope</code> method. This method will overwrite all existing scopes:</p>
            <pre><code>return Socialite::driver('github')
            -&gt;scopes(['scope1', 'scope2'])-&gt;redirect();
</code></pre>
            <p>Of course, you will need to define routes to your controller methods:</p>
            <pre><code>Route::get('auth/github', 'Auth\AuthController@redirectToProvider');
Route::get('auth/github/callback', 'Auth\AuthController@handleProviderCallback');
</code></pre>
            <p>A number of OAuth providers support optional parameters in the redirect request. To include any optional parameters in the request, call the <code>with</code> method with an associative array:</p>
            <pre><code>return Socialite::driver('google')
            -&gt;with(['hd' =&gt; 'example.com'])-&gt;redirect();
</code></pre>
            <h4>Retrieving User Details</h4>
            <p>Once you have a user instance, you can grab a few more details about the user:</p>
            <pre><code>$user = Socialite::driver('github')-&gt;user();

// OAuth Two Providers
$token = $user-&gt;token;

// OAuth One Providers
$token = $user-&gt;token;
$tokenSecret = $user-&gt;tokenSecret;

// All Providers
$user-&gt;getId();
$user-&gt;getNickname();
$user-&gt;getName();
$user-&gt;getEmail();
$user-&gt;getAvatar();
</code></pre>
            <p>
                <a name="adding-custom-authentication-drivers"></a>
            </p>
            <h2>Adding Custom Authentication Drivers</h2>
            <p>If you are not using a traditional relational database to store your users, you will need to extend Laravel with your own authentication driver. We will use the <code>extend</code> method on the <code>Auth</code> facade to define a custom
                driver. You should place this call to <code>extend</code> within a <a href="providers">service provider</a>:</p>
            <pre><code>&lt;?php

namespace App\Providers;

use Auth;
use App\Extensions\RiakUserProvider;
use Illuminate\Support\ServiceProvider;

class AuthServiceProvider extends ServiceProvider
{
    /**
     * Perform post-registration booting of services.
     *
     * @return void
     */
    public function boot()
    {
        Auth::extend('riak', function($app) {
            // Return an instance of Illuminate\Contracts\Auth\UserProvider...
            return new RiakUserProvider($app['riak.connection']);
        });
    }

    /**
     * Register bindings in the container.
     *
     * @return void
     */
    public function register()
    {
        //
    }
}
</code></pre>
            <p>After you have registered the driver with the <code>extend</code> method, you may switch to the new driver in your <code>config/auth.php</code> configuration file.</p>
            <h3>The User Provider Contract</h3>
            <p>The <code>Illuminate\Contracts\Auth\UserProvider</code> implementations are only responsible for fetching a <code>Illuminate\Contracts\Auth\Authenticatable</code> implementation out of a persistent storage system, such as MySQL, Riak, etc.
                These two interfaces allow the Laravel authentication mechanisms to continue functioning regardless of how the user data is stored or what type of class is used to represent it.</p>
            <p>Let's take a look at the <code>Illuminate\Contracts\Auth\UserProvider</code> contract:</p>
            <pre><code>&lt;?php

namespace Illuminate\Contracts\Auth;

interface UserProvider {

    public function retrieveById($identifier);
    public function retrieveByToken($identifier, $token);
    public function updateRememberToken(Authenticatable $user, $token);
    public function retrieveByCredentials(array $credentials);
    public function validateCredentials(Authenticatable $user, array $credentials);

}
</code></pre>
            <p>The <code>retrieveById</code> function typically receives a key representing the user, such as an auto-incrementing ID from a MySQL database. The <code>Authenticatable</code> implementation matching the ID should be retrieved and returned
                by the method.</p>
            <p>The <code>retrieveByToken</code> function retrieves a user by their unique <code>$identifier</code> and &quot;remember me&quot; <code>$token</code>, stored in a field <code>remember_token</code>. As with the previous method, the <code>Authenticatable</code>                implementation should be returned.</p>
            <p>The <code>updateRememberToken</code> method updates the <code>$user</code> field <code>remember_token</code> with the new <code>$token</code>. The new token can be either a fresh token, assigned on a successful &quot;remember me&quot; login
                attempt, or a null when the user is logged out.</p>
            <p>The <code>retrieveByCredentials</code> method receives the array of credentials passed to the <code>Auth::attempt</code> method when attempting to sign into an application. The method should then &quot;query&quot; the underlying persistent
                storage for the user matching those credentials. Typically, this method will run a query with a &quot;where&quot; condition on <code>$credentials['username']</code>. The method should then return an implementation of <code>UserInterface</code>.
                <strong>This method should not attempt to do any password validation or authentication.</strong>
            </p>
            <p>The <code>validateCredentials</code> method should compare the given <code>$user</code> with the <code>$credentials</code> to authenticate the user. For example, this method might compare the <code>$user-&gt;getAuthPassword()</code> string
                to a <code>Hash::make</code> of <code>$credentials['password']</code>. This method should only validate the user's credentials and return a boolean.</p>
            <h3>The Authenticatable Contract</h3>
            <p>Now that we have explored each of the methods on the <code>UserProvider</code>, let's take a look at the <code>Authenticatable</code> contract. Remember, the provider should return implementations of this interface from the <code>retrieveById</code>                and <code>retrieveByCredentials</code> methods:</p>
            <pre><code>&lt;?php

namespace Illuminate\Contracts\Auth;

interface Authenticatable {

    public function getAuthIdentifier();
    public function getAuthPassword();
    public function getRememberToken();
    public function setRememberToken($value);
    public function getRememberTokenName();

}
</code></pre>
            <p>This interface is simple. The <code>getAuthIdentifier</code> method should return the &quot;primary key&quot; of the user. In a MySQL back-end, again, this would be the auto-incrementing primary key. The <code>getAuthPassword</code> should
                return the user's hashed password. This interface allows the authentication system to work with any User class, regardless of what ORM or storage abstraction layer you are using. By default, Laravel includes a <code>User</code> class in
                the <code>app</code> directory which implements this interface, so you may consult this class for an implementation example.</p>
            <p>
                <a name="events"></a>
            </p>
            <h2>Events</h2>
            <p>Laravel raises a variety of <a href="events">events</a> during the authentication process. You may attach listeners to these events in your <code>EventServiceProvider</code>:</p>
            <pre><code>/**
 * Register any other events for your application.
 *
 * @param  \Illuminate\Contracts\Events\Dispatcher  $events
 * @return void
 */
public function boot(DispatcherContract $events)
{
    parent::boot($events);

    // Fired on each authentication attempt...
    $events-&gt;listen('auth.attempt', function ($credentials, $remember, $login) {
        //
    });

    // Fired on successful logins...
    $events-&gt;listen('auth.login', function ($user, $remember) {
        //
    });

    // Fired on logouts...
    $events-&gt;listen('auth.logout', function ($user) {
        //
    });
}
</code></pre>

        </article>
    </div>


    <footer class="main">
        <ul>
            <li class="nav-docs"><a href="http://www.golaravel.com/laravel/docs/">中文文档</a>
            </li>
            <li class="nav-community"><a href="http://wenda.golaravel.com" target="_blank">问答社区</a>
            </li>
            <li class="nav-api"><a href="http://laravel.com/api/5.0/" target="_blank">API</a>
            </li>
            <li class="nav-laracasts"><a href="https://laracasts.com" target="_blank">视频教程（国外）</a>
            </li>
            <li class="nav-forge"><a href="https://forge.laravel.com" target="_blank">Forge</a>
            </li>

        </ul>
        <p>Laravel is a trademark of Taylor Otwell. Copyright &copy; Taylor Otwell.</p>
        <p class="less-significant"><a href="http://jackmcdade.com" target="_blank">Design by Jack McDade</a>
        </p>
    </footer>

    <script src="../../assets/js/laravel.js"></script>
    <script src="../../assets/js/viewport-units-buggyfill.js"></script>
    <script>
        window.viewportUnitsBuggyfill.init();
    </script>
    <script type="text/javascript">
        var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
        document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fc8d13872a523d9c286aa7affbe0921f1' type='text/javascript'%3E%3C/script%3E"));
    </script>
</body>

</html>